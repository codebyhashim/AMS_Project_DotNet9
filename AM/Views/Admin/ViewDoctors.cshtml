 @model List<DoctorModel>

@* @{
    ViewData["Title"] = "Index";
}
 <h1>admin dashboard</h1> 

<a asp-action="Create" asp-controller="Doctor" class="btn btn-primary btn-sm">Create Doctor</a>

@if (TempData["SuccessMessage"] != null)
{
    <div class="alert alert-success" role="alert">
        @TempData["SuccessMessage"]
    </div>
}
@if (TempData["deleteMessage"] != null)
{
    <div class="alert alert-success" role="alert">
        @TempData["deleteMessage"]
    </div>
}
@if (TempData["UpdatedMessage"] != null)
{
    <div class="alert alert-success" role="alert">
        @TempData["UpdatedMessage"]
    </div>
}

<!-- DataTales Example -->
<div class="card shadow mb-4">

    <div class="card-body table-responsive">

        <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
            <thead>
                <tr>
                    <th>Contact Information</th>

                    <th>Availability Information</th>
                    <th>Experience</th>
                    <th>Speciality</th>
                    <th>Degree</th>
                    <th>IsActive</th>
                    <th colspan="3">Actions</th>
                </tr>
            </thead>

            <tbody>
                @foreach (var item in Model)
                {
                        <tr>
                        <td>Name: @item.Name  <br /> Email : @item.Email   <br /> PhoneNumber: @item.PhoneNumber <br /> City: @item.City </td>
                        <td>WaitTime: @item.WaitTime  <br />AvailabilityDays: @item.AvailabilityDays  <br />AvailabilityHours: @item.AvailabilityHours</td>
                        <td>@item.Experience</td>
                        <td>@item.Speciality</td>
                        <td>@item.Degree</td>
                        <td>@item.IsActive</td>
                            <td>
                            @if (item.UserId == null)
                            {
                                        <form asp-controller="Doctor" asp-route-id="@item.Id" asp-action="DoctorUser" method="post">
                                            <button class="btn btn-sm text-white" style="background-color: #4e73df">Invite</button>
                                        </form>
                            }
                            </td>

                            <td>
                                <a class="btn btn-sm text-white" style="background-color: #4e73df" asp-action="Edit" asp-route-id="@item.Id">Edit</a>
                            </td>
                            <td>
                                <a class="btn btn-danger btn-sm" asp-action="Delete" asp-route-id="@item.Id">Delete</a>
                            </td>
                        </tr>
                }
            </tbody>
        </table>

    </div> <!-- Close card-body div -->

</div> <!-- Close card div -->

 *@


@* @await Component.InvokeAsync("Inventory") *@
@* <link href="/vendor/fontawesome-free/css/all.min.css" rel="stylesheet" type="text/css">
<link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i"
      rel="stylesheet">
<link href="/css/sb-admin-2.min.css" rel="stylesheet">
<link href="/vendor/datatables/dataTables.bootstrap4.min.css" rel="stylesheet"> *@
@{
	ViewData["Title"] = "Index";
}


@if (TempData["SuccessMessage"] != null)
{
	<div class="alert alert-success UpdatedMessage" role="alert">
		@TempData["SuccessMessage"]
	</div>
}
@if (TempData["deleteMessage"] != null)
{
	<div class="alert alert-success UpdatedMessage" role="alert">
		@TempData["deleteMessage"]
	</div>
}
@if (TempData["UpdatedMessage"] != null)
{
	<div class="alert alert-success UpdatedMessage" role="alert">
		@TempData["UpdatedMessage"]
	</div>
}
@if (TempData["Lock"] != null)
{
	<div class="alert alert-success LockMessage" role="alert">
		@TempData["Lock"]
	</div>
}
<div class="card shadow mb-4">
	<div class="card-header py-3" style="display:flex;justify-content:end">

		<a asp-action="Create" asp-controller="Doctor" class="btn btn-primary btn-sm">Add Doctor</a>

	</div>

	<div class="card-body">
		<div class="table-responsive">
			<table class="table table-bordered" id="dataTable" width="100%">
				<thead>
					<tr>

						<th>Contact Information</th>
						<th>Availability Information</th>
						<th>Qualification</th>
						<th>Experience</th>
						@* <th>Speciality</th>
                        <th>Degree</th> *@
						<th>About Details</th>
						@* <th>avalabilies days</th> *@


						<th>IsActive</th>
						<th>Actions</th>
					</tr>

				</thead>
				<tbody>
					@foreach (var item in Model)
					{
						<!-- Modal for confirmation -->
						<div class="modal fade" id="deleteModal" tabindex="-1" aria-labelledby="deleteModalLabel" aria-hidden="true">
							<div class="modal-dialog">
								<div class="modal-content">
									<div class="modal-header">
										<h5 class="modal-title" id="deleteModalLabel">Confirm Deletion</h5>
										<button type="button" class="close" data-dismiss="modal" aria-label="Close">
											<span aria-hidden="true">&times;</span>
										</button>
									</div>
									<div class="modal-body">
										<p>Are you sure you want to delete this doctor?</p>
										<form id="deleteForm" method="post" asp-controller="Doctor" asp-action="Delete" asp-route-id="@item.Id">
											<input type="hidden" id="doctorId" name="Id" />
											<div class="form-group">
												<a class="btn btn-secondary btn-sm" data-dismiss="modal">Cancel</a>
												<button type="submit" class="btn btn-danger btn-sm">Delete</button>
											</div>
										</form>

									</div>
								</div>
							</div>
						</div>



						<tr>
							<td>
								Name: @item.Name  <br /> 
								Email : @item.Email   <br /> 
								PhoneNumber: @item.PhoneNumber <br />
								City: @item.City<br /> 
								Address: @item.Address
							</td>
							<td>
								WaitTime: @item.WaitTime
								<br />
								AvailabilityTimeSlot:
								<br />
								@item.AvailabilityTimeSlot
								<br />
								AvailabilityDays:
								<br />
								@foreach (var dayString in item.AvailabilityDays.Split(','))
								{
									// Try to parse the string as an integer
									if (int.TryParse(dayString, out int dayInt) && Enum.IsDefined(typeof(DayOfWeek), dayInt))
									{

										// Convert the integer to DayOfWeek enum and display the day name
										DayOfWeek day = (DayOfWeek)dayInt;
										@day  <!-- This will display the name like Sunday, Monday, etc. -->
									}
								}
							</td>
							<td>
								Speciality :@item.Speciality  <br />   Degree: @item.Degree



							</td>
							<td>@item.Experience</td>
							<td>@item.Description</td>
							@* <td>
								AvailabilityDays: <br />
								@foreach (var dayString in item.AvailabilityDays.Split(','))
								{
									// Try to parse the string as an integer
									if (int.TryParse(dayString, out int dayInt) && Enum.IsDefined(typeof(DayOfWeek), dayInt))
									{

										// Convert the integer to DayOfWeek enum and display the day name
										DayOfWeek day = (DayOfWeek)dayInt;
										@day  <!-- This will display the name like Sunday, Monday, etc. -->
									}
								}
								 </td> *@
							<form asp-controller="Admin" asp-route-id="@item.Id" asp-action="ShowDoctor" method="post">
							<td class="text-center pt-5">
									@if (@item.IsActive)
									{
									<button type="submit" style="border: none;background: transparent; cursor: pointer;">
										<i class="fa-solid fa-lock-open " style="color: green; font-size: 25px; "></i>
									</button>
									}
									else
									{
									<button style="border: none;background: transparent; cursor: pointer;" type="submit"><i class="fa-solid fa-lock fa-2x" style="color: red; font-size: 25px"></i></button>
									}
							</td>

							</form>


							<td style="display:flex;justify-content:space-around;  " class="pt-5">
								@if (item.UserId == null)
								{
									<form asp-controller="Admin" asp-route-id="@item.Id" asp-action="DoctorUser" method="post">
										@* <button type="submit" class="btn btn-sm text-white" style="background-color: #4e73df">Invite</button>  *@

										<button type="submit" style="font-size: 20px; color: #4CAF50; background-color: transparent; border: none; padding: 0; "> <i class="fas fa-paper-plane fa-1x"></i></button>

									</form>
								}
							
							


								@* <a class="btn btn-sm text-white" style="background-color: #4e73df" asp-action="Edit" asp-route-id="@item.Id">Edit</a> *@

								<a asp-action="Edit" asp-controller="Admin" asp-route-id="@item.Id" style="font-size: 20px;color: color: #2196F3;">
									<i class="fas fa-edit fa-1x"></i>
								</a>

								@* <a class="btn btn-danger btn-sm" asp-action="Delete" asp-route-id="@item.Id">Delete<i class="fa-solid fa-trash"></i></a> *@
								@* <a data-toggle="modal" data-target="#deleteModal" asp-action="Delete" asp-controller="Admin"
								   data-id="@item.Id"  asp-route-id="@item.Id" style="font-size: 20px;color: #FF5733"><i class="fa-solid fa-trash fa-1x"></i></a> *@


								<a class="delete-btn" data-toggle="modal" data-target="#deleteModal"
								   data-id="@item.Id"  style="font-size: 20px;color: #FF5733 ; cursor: pointer"><i class="fa-solid fa-trash fa-1x"></i></a>
								@* asp-route-id="@item.Id" *@
					

							</td>
						</tr>
		

					}
				</tbody>




			</table>

		</div>
	</div>

</div>









 

@section scripts {
	<script src="~/Theme/vendor/jquery/jquery.min.js"></script>
	<script src="~/Theme/vendor/jquery-easing/jquery.easing.min.js"></script>
	<script src="~/Theme/js/sb-admin-2.min.js"></script>
	<script src="~/Theme/vendor/datatables/jquery.dataTables.min.js"></script>
	<script src="~/Theme/vendor/datatables/dataTables.bootstrap4.min.js"></script>
	<script src="~/Theme/js/demo/datatables-demo.js"></script>
}

<script>


		setTimeout(function(){
		var msg = document.querySelector(".UpdatedMessage");
		if (msg) {
			msg.remove();
		}
	}, 1000);

	setTimeout(function(){
		var msges = document.querySelector(".LockMessage");
		if (msges) {
			msges.remove();
		}
	}, 1000);

</script>

<script>
		$(document).ready(function() {
		$('.delete-btn').on('click', function() {
			var itemId = $(this).data('id');  // Get the ID of the item to be deleted
			$('#doctorId').val(itemId);  // Set the hidden input value to the item ID
			$('#deleteForm').attr('action', '/Doctor/Delete/' + itemId);  // Update the form action dynamically
		});
	});



</script>
